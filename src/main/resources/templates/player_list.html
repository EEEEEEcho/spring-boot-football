<!DOCTYPE html>
<html lang="en" xmlns:th="http://www.thymeleaf.org">

<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="">
    <meta name="author" content="Dashboard">
    <meta name="keyword" content="Dashboard, Bootstrap, Admin, Template, Theme, Responsive, Fluid, Retina">
    <title>球员列表</title>

    <!-- Favicons -->
    <link th:href="@{/img/favicon.png}" rel="icon">
    <link th:href="@{/img/apple-touch-icon.png}" rel="apple-touch-icon">

    <!-- Bootstrap core CSS -->
    <link th:href="@{/lib/bootstrap/css/bootstrap.min.css}" rel="stylesheet">
    <!--external css-->
    <link th:href="@{/lib/font-awesome/css/font-awesome.css}" rel="stylesheet"/>
    <link th:href="@{/lib/advanced-datatable/css/demo_page.css}" rel="stylesheet"/>
    <link th:href="@{/lib/advanced-datatable/css/demo_table.css}" rel="stylesheet"/>
    <link rel="stylesheet" th:href="@{/lib/advanced-datatable/css/DT_bootstrap.css}"/>
    <!-- Custom styles for this template -->
    <link th:href="@{/css/style.css}" rel="stylesheet">
    <link th:href="@{/css/style-responsive.css}" rel="stylesheet">
    <!--    xchart css-->
    <link rel="stylesheet" th:href="@{/lib/xchart/xcharts.css}">
    <!-- =======================================================
      Template Name: Dashio
      Template URL: https://templatemag.com/dashio-bootstrap-admin-template/
      Author: TemplateMag.com
      License: https://templatemag.com/license/
    ======================================================= -->
</head>

<body>
<section id="container">
    <!-- **********************************************************************************************************************************************************
        TOP BAR CONTENT & NOTIFICATIONS
        *********************************************************************************************************************************************************** -->
    <!--header start-->
    <div th:replace="~{commons/common::topbar}"></div>
    <!--header end-->
    <!-- **********************************************************************************************************************************************************
        MAIN SIDEBAR MENU
        *********************************************************************************************************************************************************** -->
    <!--sidebar start-->
    <div th:replace="~{commons/common::sidebar(active='player.html',type=${type})}"></div>
    <!--sidebar end-->
    <!-- **********************************************************************************************************************************************************
        MAIN CONTENT
        *********************************************************************************************************************************************************** -->
    <!--main content start-->
    <p id="typeTag" th:text="${type}" style="display: none"></p>
    <section id="main-content">
        <section class="wrapper">
            <h3><i class="fa fa-angle-right"></i>射手</h3>
            <div class="row mb">
                <!-- page start-->
                <div class="content-panel">
                    <div class="adv-table">
                        <table cellpadding="0" cellspacing="0" border="0" class="display table table-bordered"
                               id="hidden-table-info">
                            <thead>
                            <tr>
                                <th></th>
                                <th>排名</th>
                                <th>球员</th>
                                <th>球队</th>
                                <th>进球</th>
                                <th>点球</th>
                                <th>出场次数</th>
                                <th>出场时间</th>
                                <th>射门</th>
                                <th>射正</th>
                            </tr>
                            </thead>
                            <tbody>
                            <tr class="gradeC" th:each="player:${players}">
                                <td><img th:src="@{/lib/advanced-datatable/images/details_open.png}"></td>
                                <td th:text="${playerStat.index + 1}"></td>
                                <td th:text="${player.getPlayerName()}"></td>
                                <td th:text="${player.getTeam()}"></td>
                                <td th:text="${player.getGoals()}"></td>
                                <td th:text="${player.getAttPenGoal()}"></td>
                                <td th:text="${player.getGames()}"></td>
                                <td th:text="${player.getMinsPlayed()}"></td>
                                <td th:text="${player.getTotalScoringAtt()}"></td>
                                <td th:text="${player.getOntargetScoringAtt()}"></td>
                            </tr>
                            </tbody>
                        </table>
                    </div>
                </div>
                <!-- page end-->
            </div>
            <!-- /row -->
            <!-- page start-->
            <!--            <h3><i class="fa fa-angle-right"></i> Flot Charts</h3>-->
            <!-- page start-->
            <div class="flot-chart">
                <!-- page start-->
                <div class="row mt" style="display: none">
                    <div class="col-lg-12">
                        <div class="content-panel">
                            <h4><i class="fa fa-angle-right"></i> Tracking Chart</h4>
                            <div class="panel-body">
                                <div id="chart-1" class="chart"></div>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="row mt">
                    <div class="col-lg-6">
                        <div class="content-panel">
                            <h4><i class="fa fa-angle-right"></i>前50位球员综合分析</h4>
                            <div class="panel-body">
                                <div id="chart-2" class="chart"></div>
                            </div>
                        </div>
                    </div>
                    <div class="col-lg-6">
                        <div class="content-panel">
                            <h4><i class="fa fa-angle-right"></i>前50位球员进球，点射，射正比例</h4>
                            <div class="panel-body">
                                <div id="chart-5" style="height:350px;"></div>
                                <div class="btn-toolbar">
                                    <div class="btn-group stackControls">
                                        <input type="button" class="btn btn-info" value="With stacking"/>
                                        <input type="button" class="btn btn-danger" value="Without stacking"/>
                                    </div>
                                    <div class="space5"></div>
                                    <div class="btn-group graphControls">
                                        <input type="button" class="btn" value="Bars"/>
                                        <input type="button" class="btn" value="Lines"/>
                                        <input type="button" class="btn" value="Lines with steps"/>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <!--/coontent-panel -->
                    </div>
                </div>
                <div class="row mt" style="display: none">
                    <div class="col-lg-6">
                        <div class="content-panel">
                            <h4><i class="fa fa-angle-right"></i> Support Chart</h4>
                            <div class="panel-body">
                                <div id="chart-4" class="chart"></div>
                            </div>
                        </div>
                    </div>
                    <div class="col-lg-6">
                        <div class="content-panel">
                            <h4><i class="fa fa-angle-right"></i> Live Chart</h4>
                            <div class="panel-body">
                                <div id="chart-3" class="chart"></div>
                            </div>
                        </div>
                    </div>
                </div>
                <!-- row -->
            </div>
        </section>
    </section>

    <!-- /MAIN CONTENT -->
    <!--main content end-->
    <!--footer start-->
    <!--footer end-->
</section>
<!-- js placed at the end of the document so the pages load faster -->
<script th:src="@{/lib/jquery/jquery.min.js}"></script>
<script type="text/javascript" language="javascript" th:src="@{/lib/advanced-datatable/js/jquery.js}"></script>
<script th:src="@{/lib/bootstrap/js/bootstrap.min.js}"></script>
<script class="include" type="text/javascript" th:src="@{/lib/jquery.dcjqaccordion.2.7.js}"></script>
<script th:src="@{/lib/jquery.scrollTo.min.js}"></script>
<script th:src="@{/lib/jquery.nicescroll.js}" type="text/javascript"></script>
<script type="text/javascript" language="javascript"
        th:src="@{/lib/advanced-datatable/js/jquery.dataTables.js}"></script>
<script type="text/javascript" th:src="@{/lib/advanced-datatable/js/DT_bootstrap.js}"></script>
<!--common script for all pages-->
<script th:src="@{/lib/common-scripts.js}"></script>
<!--script for this page-->
<script type="text/javascript">
    /* Formating function for row details */
    function fnFormatDetails(oTable, nTr) {
        var aData = oTable.fnGetData(nTr);
        var sOut = '<table cellpadding="5" cellspacing="0" border="0" style="padding-left:50px;">';
        sOut += '<tr><td>Rendering engine:</td><td>' + aData[1] + ' ' + aData[4] + '</td></tr>';
        sOut += '<tr><td>Link to source:</td><td>Could provide a link here</td></tr>';
        sOut += '<tr><td>Extra info:</td><td>And any further details here (images etc)</td></tr>';
        sOut += '</table>';

        return sOut;
    }

    $(document).ready(function () {
        /*
         * Insert a 'details' column to the table
         */
        // var nCloneTh = document.createElement('th');
        // var nCloneTd = document.createElement('td');
        // nCloneTd.innerHTML = '<img src="/img/details_open.png">';
        // nCloneTd.className = "center";
        //
        // $('#hidden-table-info thead tr').each(function () {
        //     this.insertBefore(nCloneTh, this.childNodes[0]);
        // });
        //
        // $('#hidden-table-info tbody tr').each(function () {
        //     this.insertBefore(nCloneTd.cloneNode(true), this.childNodes[0]);
        // });

        /*
         * Initialse DataTables, with no sorting on the 'details' column
         */
        var oTable = $('#hidden-table-info').dataTable({
            "aoColumnDefs": [{
                "bSortable": false,
                "aTargets": [0]
            }],
            "aaSorting": [
                [1, 'asc']
            ]
        });

        /* Add event listener for opening and closing details
         * Note that the indicator for showing which row is open is not controlled by DataTables,
         * rather it is done here
         */
        // $('#hidden-table-info tbody td img').live('click', function () {
        //     var nTr = $(this).parents('tr')[0];
        //     if (oTable.fnIsOpen(nTr)) {
        //         /* This row is already open - close it */
        //         this.src = "../static/lib/advanced-datatable/media/images/details_open.png";
        //         oTable.fnClose(nTr);
        //     } else {
        //         /* Open this row */
        //         this.src = "../static/lib/advanced-datatable/images/details_close.png";
        //         oTable.fnOpen(nTr, fnFormatDetails(oTable, nTr), 'details');
        //     }
        // });
    });
</script>
<!--script for flot chart-->
<script th:src="@{/lib/flot/jquery.flot.js}"></script>
<script th:src="@{/lib/flot/jquery.flot.resize.js}"></script>
<script th:src="@{/lib/flot/jquery.flot.stack.js}"></script>
<script th:src="@{/lib/flot/jquery.flot.crosshair.js}"></script>
<script th:inline="none">
    var typeTag = document.getElementById("typeTag")
    console.log(typeTag.innerHTML)
    url = "http://localhost:8080/football/api/player/" + typeTag.innerHTML
    playerData = null
    $.ajax({
        type:'GET',
        async : false,
        url : url,
        dataType: 'json',
        success : function (result) {
            playerData = result
        }
    });
    goals = []
    attGoal = []
    totalAtt = []
    ontarget = []
    for(var i = 0;i < playerData.length;i ++){
        goals.push([i,playerData[i]['goals']])
        attGoal.push([i,playerData[i]['attPenGoal']])
        totalAtt.push([i,playerData[i]['totalScoringAtt']])
        ontarget.push([i,playerData[i]['ontargetScoringAtt']])
    }
    var Script = function () {

//  tracking chart

        var plot;
        $(function () {
            var sin = [], cos = [];
            for (var i = 0; i < 14; i += 0.1) {
                sin.push([i, Math.sin(i)]);
                cos.push([i, Math.cos(i)]);
            }

            plot = $.plot($("#chart-1"),
                [{data: sin, label: "sin(x) = -0.00"},
                    {data: cos, label: "cos(x) = -0.00"}], {
                    series: {
                        lines: {show: true}
                    },
                    crosshair: {mode: "x"},
                    grid: {hoverable: true, autoHighlight: false},
                    yaxis: {min: -1.2, max: 1.2}
                });
            var legends = $("#chart-1 .legendLabel");
            legends.each(function () {
                // fix the widths so they don't jump around
                $(this).css('width', $(this).width());
            });

            var updateLegendTimeout = null;
            var latestPosition = null;

            function updateLegend() {
                updateLegendTimeout = null;

                var pos = latestPosition;

                var axes = plot.getAxes();
                if (pos.x < axes.xaxis.min || pos.x > axes.xaxis.max ||
                    pos.y < axes.yaxis.min || pos.y > axes.yaxis.max)
                    return;

                var i, j, dataset = plot.getData();
                for (i = 0; i < dataset.length; ++i) {
                    var series = dataset[i];

                    // find the nearest points, x-wise
                    for (j = 0; j < series.data.length; ++j)
                        if (series.data[j][0] > pos.x)
                            break;

                    // now interpolate
                    var y, p1 = series.data[j - 1], p2 = series.data[j];
                    if (p1 == null)
                        y = p2[1];
                    else if (p2 == null)
                        y = p1[1];
                    else
                        y = p1[1] + (p2[1] - p1[1]) * (pos.x - p1[0]) / (p2[0] - p1[0]);

                    legends.eq(i).text(series.label.replace(/=.*/, "= " + y.toFixed(2)));
                }
            }

            $("#chart-1").bind("plothover", function (event, pos, item) {
                latestPosition = pos;
                if (!updateLegendTimeout)
                    updateLegendTimeout = setTimeout(updateLegend, 50);
            });
        });

//    selection chart
        console.log(goals)
        $(function () {
            var data = [
                {
                    label: "进球",
                    data: goals
                },
                {
                    label: "点球",
                    data: attGoal
                },
                {
                    label: "射门",
                    data: totalAtt
                },
                {
                    label: "射正",
                    data: ontarget
                }
            ];

            var options = {
                series: {
                    lines: {show: true},
                    points: {show: true}
                },
                legend: {noColumns: 2},
                xaxis: {tickDecimals: 0},
                yaxis: {min: 0},
                selection: {mode: "x"}
            };

            var placeholder = $("#chart-2");

            placeholder.bind("plotselected", function (event, ranges) {
                $("#selection").text(ranges.xaxis.from.toFixed(1) + " to " + ranges.xaxis.to.toFixed(1));

                var zoom = $("#zoom").attr("checked");
                if (zoom)
                    plot = $.plot(placeholder, data,
                        $.extend(true, {}, options, {
                            xaxis: {min: ranges.xaxis.from, max: ranges.xaxis.to}
                        }));
            });

            placeholder.bind("plotunselected", function (event) {
                $("#selection").text("");
            });

            var plot = $.plot(placeholder, data, options);

            $("#clearSelection").click(function () {
                plot.clearSelection();
            });

            $("#setSelection").click(function () {
                plot.setSelection({xaxis: {from: 1994, to: 1995}});
            });
        });

//    live chart

        $(function () {
            // we use an inline data source in the example, usually data would
            // be fetched from a server
            var data = [], totalPoints = 300;

            function getRandomData() {
                // if (data.length > 0)
                //     data = data.slice(1);
                //
                // // do a random walk
                // while (data.length < totalPoints) {
                //     var prev = data.length > 0 ? data[data.length - 1] : 50;
                //     var y = prev + Math.random() * 10 - 5;
                //     if (y < 0)
                //         y = 0;
                //     if (y > 100)
                //         y = 100;
                //     data.push(y);
                // }

                // zip the generated y values with the x values
                var res = [];
                for (var i = 0; i < playerData.length; ++i)
                    res.push([i, playerData[i]['goals']])
                return res;
            }

            // setup control widget
            var updateInterval = 30;
            $("#updateInterval").val(updateInterval).change(function () {
                var v = $(this).val();
                if (v && !isNaN(+v)) {
                    updateInterval = +v;
                    if (updateInterval < 1)
                        updateInterval = 1;
                    if (updateInterval > 2000)
                        updateInterval = 2000;
                    $(this).val("" + updateInterval);
                }
            });

            // setup plot
            var options = {
                series: {shadowSize: 0}, // drawing is faster without shadows
                yaxis: {min: 0, max: 100},
                xaxis: {show: false}
            };
            var plot = $.plot($("#chart-3"), [getRandomData()], options);

            function update() {
                plot.setData([getRandomData()]);
                // since the axes don't change, we don't need to call plot.setupGrid()
                plot.draw();

                setTimeout(update, updateInterval);
            }

            update();
        });

//    support chart

        $(function () {
            var d1 = [];
            for (var i = 0; i < 14; i += 0.5)
                d1.push([i, Math.sin(i)]);

            var d2 = [[0, 3], [4, 8], [8, 5], [9, 13]];

            var d3 = [];
            for (var i = 0; i < 14; i += 0.5)
                d3.push([i, Math.cos(i)]);

            var d4 = [];
            for (var i = 0; i < 14; i += 0.1)
                d4.push([i, Math.sqrt(i * 10)]);

            var d5 = [];
            for (var i = 0; i < 14; i += 0.5)
                d5.push([i, Math.sqrt(i)]);

            var d6 = [];
            for (var i = 0; i < 14; i += 0.5 + Math.random())
                d6.push([i, Math.sqrt(2 * i + Math.sin(i) + 5)]);

            $.plot($("#chart-4"), [
                {
                    data: d1,
                    lines: {show: true, fill: true}
                },
                {
                    data: d2,
                    bars: {show: true}
                },
                {
                    data: d3,
                    points: {show: true}
                },
                {
                    data: d4,
                    lines: {show: true}
                },
                {
                    data: d5,
                    lines: {show: true},
                    points: {show: true}
                },
                {
                    data: d6,
                    lines: {show: true, steps: true}
                }
            ]);
        });

//    bar chart

        $(function () {
            var d1 = [];
            for (var i = 0; i < 50; i += 1)
                d1.push([i, playerData[i]['goals']]);

            var d2 = [];
            for (var i = 0; i <50; i += 1)
                d2.push([i, playerData[i]['attPenGoal']]);

            var d3 = [];
            for (var i = 0; i < 50; i += 1)
                d3.push([i, playerData[i]['ontargetScoringAtt']]);

            var stack = 0, bars = true, lines = false, steps = false;

            function plotWithOptions() {
                $.plot($("#chart-5"), [d1, d2, d3], {
                    series: {
                        stack: stack,
                        lines: {show: lines, fill: true, steps: steps},
                        bars: {show: bars, barWidth: 0.6}
                    }
                });
            }

            plotWithOptions();

            $(".stackControls input").click(function (e) {
                e.preventDefault();
                stack = $(this).val() == "With stacking" ? true : null;
                plotWithOptions();
            });
            $(".graphControls input").click(function (e) {
                e.preventDefault();
                bars = $(this).val().indexOf("Bars") != -1;
                lines = $(this).val().indexOf("Lines") != -1;
                steps = $(this).val().indexOf("steps") != -1;
                plotWithOptions();
            });
        });

//    graph chart


        $(function () {
            // data
            /*var data = [
             { label: "Series1",  data: 10},
             { label: "Series2",  data: 30},
             { label: "Series3",  data: 90},
             { label: "Series4",  data: 70},
             { label: "Series5",  data: 80},
             { label: "Series6",  data: 110}
             ];*/
            /*var data = [
             { label: "Series1",  data: [[1,10]]},
             { label: "Series2",  data: [[1,30]]},
             { label: "Series3",  data: [[1,90]]},
             { label: "Series4",  data: [[1,70]]},
             { label: "Series5",  data: [[1,80]]},
             { label: "Series6",  data: [[1,0]]}
             ];*/
            var data = [];
            var series = Math.floor(Math.random() * 10) + 1;
            for (var i = 0; i < series; i++) {
                data[i] = {label: "Series" + (i + 1), data: Math.floor(Math.random() * 100) + 1}
            }


            // GRAPH 1
            $.plot($("#graph1"), data,
                {
                    series: {
                        pie: {
                            show: true
                        }
                    },
                    legend: {
                        show: false
                    }
                });

            // GRAPH 2
            $.plot($("#graph2"), data,
                {
                    series: {
                        pie: {
                            show: true,
                            radius: 1,
                            label: {
                                show: true,
                                radius: 1,
                                formatter: function (label, series) {
                                    return '<div style="font-size:8pt;text-align:center;padding:2px;color:white;">' + label + '<br/>' + Math.round(series.percent) + '%</div>';
                                },
                                background: {opacity: 0.8}
                            }
                        }
                    },
                    legend: {
                        show: false
                    }
                });

            // GRAPH 3
            $.plot($("#graph3"), data,
                {
                    series: {
                        pie: {
                            show: true,
                            radius: 1,
                            label: {
                                show: true,
                                radius: 3 / 4,
                                formatter: function (label, series) {
                                    return '<div style="font-size:8pt;text-align:center;padding:2px;color:white;">' + label + '<br/>' + Math.round(series.percent) + '%</div>';
                                },
                                background: {opacity: 0.5}
                            }
                        }
                    },
                    legend: {
                        show: false
                    }
                });


            // DONUT
            $.plot($("#donut"), data,
                {
                    series: {
                        pie: {
                            innerRadius: 0.5,
                            show: true
                        }
                    }
                });


        });

        function pieHover(event, pos, obj) {
            if (!obj)
                return;
            percent = parseFloat(obj.series.percent).toFixed(2);
            $("#hover").html('<span style="font-weight: bold; color: ' + obj.series.color + '">' + obj.series.label + ' (' + percent + '%)</span>');
        }

        function pieClick(event, pos, obj) {
            if (!obj)
                return;
            percent = parseFloat(obj.series.percent).toFixed(2);
            alert('' + obj.series.label + ': ' + percent + '%');
        }


    }();
</script>
</body>

</html>
